{% extends "base.html" %}

{% block title %}{{ build['name'] }} - Auto Specs Manager{% endblock %}

{% block content %}
<div style="margin-bottom: 1rem;">
    <a href="/" class="btn">‚Üê Back to Builds</a>
    <a href="/build/{{ build['id'] }}/maintenance/add" class="btn btn-success" style="float: right;">+ Add Maintenance</a>
</div>

<div class="card">
    <h2>{{ build['name'] }}</h2>

    <h3>Specifications</h3>
    <table>
        <tr><td><strong>Displacement</strong></td><td>{{ build['displacement_ci'] }} CI</td></tr>
        <tr><td><strong>Bore</strong></td><td>{{ build['bore_in'] }} inches</td></tr>
        <tr><td><strong>Stroke</strong></td><td>{{ build['stroke_in'] }} inches</td></tr>
        <tr><td><strong>Rod Length</strong></td><td>{{ build['rod_len_in'] }} inches</td></tr>
        <tr><td><strong>Static CR</strong></td><td>{{ build['static_cr'] }}:1</td></tr>
        <tr><td><strong>Dynamic CR</strong></td><td>{{ build['dynamic_cr'] }}:1</td></tr>
        <tr><td><strong>Firing Order</strong></td><td>{{ build['firing_order'] }}</td></tr>
    </table>

    {% if build['notes'] %}
    <h3>Notes</h3>
    <p>{{ build['notes'] }}</p>
    {% endif %}
</div>

{% if parts %}
<div class="card">
    <h3>Parts List</h3>
    <table>
        <thead>
            <tr>
                <th>Category</th>
                <th>Part Name</th>
                <th>Brand</th>
                <th>Part Number</th>
                <th>Role</th>
            </tr>
        </thead>
        <tbody>
            {% for part in parts %}
            <tr>
                <td>{{ part['category'] }}</td>
                <td>{{ part['name'] }}</td>
                <td>{{ part['brand'] }}</td>
                <td>{{ part['part_number'] }}</td>
                <td>{{ part['role'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<div class="card">
    <h3>Maintenance History</h3>

    {% if events %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Description</th>
                <th>Engine Hours</th>
                <th>Odometer</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for event in events %}
            <tr>
                <td>{{ event['event_date'] }}</td>
                <td>{{ event['event_type'] }}</td>
                <td>{{ event['description'] }}</td>
                <td>{{ event['engine_hours'] if event['engine_hours'] else 'N/A' }}</td>
                <td>{{ event['odometer'] if event['odometer'] else 'N/A' }}</td>
                <td><a href="/maintenance/{{ event['id'] }}" class="btn">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No maintenance records yet. <a href="/build/{{ build['id'] }}/maintenance/add">Add the first one!</a></p>
    {% endif %}
</div>
{% endblock %}
